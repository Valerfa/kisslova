function addRedactor_to_textarea(t){t&&t instanceof HTMLTextAreaElement&&"yes"!==t.getAttribute("data-redactor")&&!t.classList.contains("noredactor")&&(t.setAttribute("data-redactor","yes"),tp__addRedactor_to_textarea_quill(t))}function tp__addRedactor_to_textarea_quill(t){const e=t.closest(".pe-form-group");if(!e)return;const o=t.value,l=t.getAttribute("placeholder"),r=t.parentElement,i=t.getAttribute("name"),a=e.hasAttribute("data-lid"),n=e.getAttribute("data-lid");t.style.display="none";const d=window.Quill.fixCustomStyle(o),s=`\n\t\t<div\n\t\t\tclass="pe-redactor__wrapper"\n\t\t\tdata-field="${i}"\n\t\t\t${a?`data-lid="${n}"`:""}\n\t\t>${d.html}</div>\n\t`;t.insertAdjacentHTML("afterend",s);const u=tp__record__getQuillConfig({isEmail:"y"===window.$is_email,isInContent:!0,isMobile:matchMedia("(max-width: 640px)").matches,isZero:!1,noHref:!!t.closest("[data-redactor-nohref]"),noUndercut:!!t.closest("[data-redactor-noundercut]"),noToolbar:!!t.closest("[data-redactor-notoolbar]")||!!t.closest("[data-redactor-toolbar]"),placeholder:l,toolbarContinerSelector:`.pe-redactor__wrapper[data-field="${i}"]${a?`[data-lid="${n}"]`:""} + .pe-redactor__toolbar`,toolbarClass:"pe-redactor__toolbar",editorWrapper:r,noFormula:"li_tab"===i}),c=r.querySelector(".pe-redactor__wrapper"),p=new window.Quill(c,u),b=d.styles;window.Quill.setCustomStyles(p.root,b),p.on("editor-change",(e=>{if("text-change"===e){window.waschanged="yes";const e=p.root.querySelectorAll(".quill-table__wrapper").length>0,o=!!p.root.querySelector(".ql-formula");t.value=p.root.textContent||e||o?window.Quill.getFormatContent(p.root):""}})),p.on("text-change",(()=>{"function"==typeof window.edrec__onSettingsChange&&window.edrec__onSettingsChange(),t.dispatchEvent(new Event("input"))}))}function tp__record__getQuillConfig(t){const{isZero:e,isEmail:o,isInContent:l,isMobile:r,noToolbar:i,noHref:a,noUndercut:n,noFormula:d,placeholder:s,toolbarContinerSelector:u,editorWrapper:c,toolbarClass:p,toolbarSelector:b}=t;let w={toolbar_content:{hint:!0,toolbarClass:p,editorWrapper:c,selector:b,showByClick:l,isMobile:r,callback:()=>{if(l)return;const t=document.querySelector("#for_redactor_toolbar .ql-gen_custom");t&&setTimeout((()=>{"function"==typeof window.tp__showOnboardingPinForAiFeatures&&window.tp__showOnboardingPinForAiFeatures(t,"field-in-editor")}),500)}},popup:!0,tooltip:!0,clipboard:!0,dropdown:!0,textcolor:".ql-color_custom",weightDropdown:{selector:".ql-weight_custom",enableVariableControl:!0},typograph:".ql-typograph_custom",cleanstyle:".ql-clean_custom",tilda_hotkeys:!0,toolbar:{container:u,toolbarOptions:["bold","italic","underline",{list:"ordered"},{list:"bullet"}]},more:".ql-more_custom",generate:".ql-gen_custom",shortcuts_popup:!0},_=["bold","italic","strike","underline","list","subscript","superscript","background","color","list-color","weight"];return e||o||(_.push("font","lineheight","size","letterspacing"),Object.assign(w,{fontDropdown:".ql-font_custom",sizeDropdown:".ql-size_custom",lineheightDropdown:".ql-lineheight_custom",table:!1,"quill-table":!0,table_popup:!0}),a||n||(w.undercut=".ql-undercut",_.push("undercut")),window.Quill&&window.Quill.table&&window.Quill.table.keyboardBindings&&(w.keyboard={bindings:window.Quill.table.keyboardBindings}),window.Quill&&window.Quill.table&&window.Quill.table.requiredTableFormats&&_.push(...window.Quill.table.requiredTableFormats),d||(_.push("formula"),w.tilda_formula=!0)),o||(_.push("align"),Object.assign(w,{alignDropdown:".ql-align_custom"})),!o&&"99"===window.$oplan&&e&&(Object.assign(w,{table:!1,"quill-table":!0,table_popup:!0}),window.Quill&&window.Quill.table&&window.Quill.table.keyboardBindings&&(w.keyboard={bindings:window.Quill.table.keyboardBindings}),window.Quill&&window.Quill.table&&window.Quill.table.requiredTableFormats&&_.push(...window.Quill.table.requiredTableFormats),d||(_.push("formula"),w.tilda_formula=!0)),a||(_.push("link"),w.toolbar.toolbarOptions.push("link"),Object.assign(w,{tilda_link:".ql-link_custom"})),i&&(w={},_=[]),{modules:w,formats:_,placeholder:s}}
