(()=>{"use strict";var e=function(t,n,i,s){var o;n[0]=0;for(var a=1;a<n.length;a++){var l=n[a++],r=n[a]?(n[0]|=l?1:2,i[n[a++]]):n[++a];3===l?s[0]=r:4===l?s[1]=Object.assign(s[1]||{},r):5===l?(s[1]=s[1]||{})[n[++a]]=r:6===l?s[1][n[++a]]+=r+"":l?(o=t.apply(r,e(t,r,i,["",null])),s.push(o),r[0]?n[0]|=2:(n[a-2]=0,n[a]=o)):s.push(r)}return s},t=new Map;const n={EN:{none:"None",default:"Default",sharp:"Sharp shadow",small:"Small shadow",medium:"Medium shadow",large:"Large shadow",custom:"Custom",edit:"Edit",color:"Shadow color",opacity:"Opacity",x:"X-axis",y:"Y-axis",spread:"Spread",blur:"Blur",layer:"Layer",add_layer:"Add layer",delete_layer:"Delete layer",save:"Save",cancel:"Cancel",css:"CSS",copy:"Copy",layer_deleted:"Layer deleted",restore:"Restore",user_has_unsaved_changes_title:"You have unsaved changes",user_has_unsaved_changes_msg:"Shadow settings have been changed. Are you sure you want to close this panel without saving?",go_back:"Go back",exit_without_saving:"Exit without saving",invalid_shadow:"Invalid shadow format"},RU:{none:"Нет",default:"По умолчанию",sharp:"Резкая тень",small:"Легкая тень",medium:"Средняя тень",large:"Большая тень",custom:"Настраиваемая",edit:"Ред.",color:"Цвет тени",opacity:"Непрозрачность",x:"Ось X",y:"Ось Y",spread:"Растяжение",blur:"Размытие",layer:"Слой",add_layer:"Добавить слой",delete_layer:"Удалить слой",save:"Сохранить",cancel:"Отменить",css:"CSS",copy:"Скопировать",layer_deleted:"Слой удален",restore:"Восстановить",user_has_unsaved_changes_title:"Последние изменения не сохранены",user_has_unsaved_changes_msg:"Настройки тени были изменены. Вы уверены, что хотите закрыть панель без сохранения?",go_back:"Вернуться назад",exit_without_saving:"Выйти без сохранения",invalid_shadow:"Неверный формат тени"}};let i="cc";"undefined"!=typeof window&&(i=window.location.origin.split(".").pop(),"string"==typeof i&&2===i.length||(i="cc"));const s=[`https://tilda.${i}/front/plugins/colorpicker/t-colorpicker.min.js`,`https://tilda.${i}/front/plugins/colorpicker/t-colorpicker.min.css`],o=[`https://tilda.${i}/front/plugins/previewbox/t-previewbox.min.js`,`https://tilda.${i}/front/plugins/previewbox/t-previewbox.min.css`],a=[`https://tilda.${i}/front/plugins/sortable-lite/t-sortable-lite.min.js`,`https://tilda.${i}/front/plugins/sortable-lite/t-sortable-lite.min.css`],l="https://static.tildacdn.com/lib/tplugins/shadowpicker",r=[{label:"none",empty:!0,img:`${l}/none.svg`},{label:"sharp",x:0,y:2,blur:3,spread:0,color:"#000b30",opacity:.25,img:`${l}/sharp.svg`},{label:"small",x:0,y:15,blur:30,spread:-10,color:"#000b30",opacity:.2,img:`${l}/small.svg`},{label:"medium",x:0,y:10,blur:20,spread:0,color:"#000b30",opacity:.25,img:`${l}/medium.svg`},{label:"large",x:0,y:10,blur:40,spread:-2,color:"#000b30",opacity:.3,img:`${l}/large.svg`},{label:"custom",custom:!0,img:`${l}/custom.svg`}],c={swatchesKey:window.projectid,swatchSize:18,swatchGap:4,panelGap:6,isPanelFixed:!0,clearBtnSize:12},h={selector:".tsp-panel__layer",handleSelector:".tsp-panel__layer-handle",axis:"y",isAutoUpdateEnabled:!0,dragImage:{zIndex:9999,className:"tsp-panel__drag-image"}},p={color:"#000000",opacity:1,x:0,y:0,blur:0,spread:0},d={color:{isColor:!0,placeholder:p.color,label:"color"},opacity:{isNumber:!0,min:0,max:100,factor:100,units:"%",placeholder:100*p.opacity+"%",label:"opacity"},x:{isNumber:!0,placeholder:p.x.toString(),label:"x",isSingleLine:!0},y:{isNumber:!0,placeholder:p.y.toString(),label:"y",isSingleLine:!0},blur:{isNumber:!0,min:0,placeholder:p.blur.toString(),label:"blur",isSingleLine:!0},spread:{isNumber:!0,placeholder:p.spread.toString(),label:"spread",isSingleLine:!0}},u=["color","opacity","x","y","blur","spread"],m={theme:"pe-tooltip_noir",contentAsHTML:!0,interactive:!1,minWidth:50,maxWidth:300,position:"top",delay:300};const g=function(n){var i=t.get(this);return i||(i=new Map,t.set(this,i)),(i=e(this,i.get(n)||(i.set(n,i=function(e){for(var t,n,i=1,s="",o="",a=[0],l=function(e){1===i&&(e||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,s):3===i&&(e||s)?(a.push(3,e,s),i=2):2===i&&"..."===s&&e?a.push(4,e,0):2===i&&s&&!e?a.push(5,0,!0,s):i>=5&&((s||!e&&5===i)&&(a.push(i,0,s,n),i=6),e&&(a.push(i,e,0,n),i=6)),s=""},r=0;r<e.length;r++){r&&(1===i&&l(),l(r));for(var c=0;c<e[r].length;c++)t=e[r][c],1===i?"<"===t?(l(),a=[a],i=3):s+=t:4===i?"--"===s&&">"===t?(i=1,s=""):s=t+s[0]:o?t===o?o="":s+=t:'"'===t||"'"===t?o=t:">"===t?(l(),i=1):i&&("="===t?(i=5,n=s,s=""):"/"===t&&(i<5||">"===e[r][c+1])?(l(),3===i&&(a=a[0]),i=a,(a=a[0]).push(2,0,i),i=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(l(),i=2):s+=t),3===i&&"!--"===s&&(i=4,a=a[0])}return l(),a}(n)),i),arguments,[])).length>1?i:i[0]}.bind((function(e,t){this[0]=3;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if("function"==typeof e){const n=new e(t).render();return n.append(...i.flat()),n}if("string"==typeof e){const n=["svg","circle"].includes(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return t&&Object.entries(t).forEach((e=>{let[t,i]=e;if(t.startsWith("on"))Array.isArray(i)?i.forEach((e=>n.addEventListener(t.substring(2).toLowerCase(),e))):n.addEventListener(t.substring(2).toLowerCase(),i);else if("className"===t)n.classList.add(...i.split(" "));else if("tooltip"===t)!function(e,t){if("function"!=typeof window.tooltipster||window.matchMedia("(hover: none)").matches)return;window.tooltipster([e],{...m,content:t})}(n,i);else if("bindTo"===t){if(Array.isArray(i)){const[e,t]=i;e&&"object"==typeof e&&"string"==typeof t&&(e[t]=n)}}else["string","number"].includes(typeof i)?n.setAttribute(t,i):"boolean"==typeof i&&i&&n.setAttribute(t,"")})),n.append(...i.flat()),n}if(e instanceof Element)return e}));function w(){const e=[];return{on:t=>{e.push(t)},trigger:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.forEach((e=>e(...n)))}}}function f(e){const t=(Array.isArray(e)?e:[e]).map((e=>{const t=e.split(".").pop(),n=e+(window.ver?"?v="+window.ver:"");return["js","css"].includes(t)?function(e,t){return new Promise(((n,i)=>{const s="style"===t,o=s?"link":"script",a=s?"href":"src";let l;try{const{pathname:t}=new URL(e,window.location.href);l=t}catch(t){l=e}const r=document.querySelector(`${o}[${a}*="${l}"]`);if(r)return"true"===r.getAttribute("data-loading")?(r.addEventListener("load",n),void r.addEventListener("error",i)):n();const c=document.createElement(o);c.setAttribute(a,e),s&&c.setAttribute("rel","stylesheet"),c.setAttribute("data-loading","true"),c.addEventListener("load",(()=>(c.removeAttribute("data-loading"),n()))),c.addEventListener("error",(()=>(document.head.removeChild(c),i()))),document.head.appendChild(c)}))}(n,"js"===t?"script":"style"):Promise.reject("Unknown resource extension. Make sure the resource url ends with .css or .js")}));return Promise.all(t)}function v(e,t){const n=function(e){return e="string"==typeof e?e.replace(/#/g,""):"",[parseInt(e.substring(0,2),16)||0,parseInt(e.substring(2,4),16)||0,parseInt(e.substring(4,6),16)||0]}(e);return`rgba(${n.join(",")},${t})`}function y(e){return(e=Array.isArray(e)?e:[e]).filter((e=>{let{isDeleted:t}=e;return!t})).map((e=>{const t=["x","y","blur","spread","color","opacity"];if(t.every((t=>[null,void 0,p[t]].includes(e[t]))))return"";const n={...e};t.forEach((e=>{if("color"===e)n[e]=n[e]||p[e];else{const t=parseInt(n[e],10);n[e]=isNaN(t)?p[e]:n[e]}}));const{x:i,y:s,blur:o,spread:a,color:l,opacity:r}=n,c=v(l,r);return`${i}px ${s}px${o!==p.blur||a!==p.spread?` ${o}px`:""}${a!==p.spread?` ${a}px`:""} ${c}`})).filter((e=>e)).join(",")}function b(e,t,n){return Math.max(e,Math.min(t,n))}function _(e,t){return n[t][e]||n.EN[e]||e}async function $(e,t){if((e=(e="string"==typeof e?e:"").toLowerCase().replace(/(box|text)-shadow:/g,"").replace(/;/g,",").replace(/\n/g,"").replace(/,$/,"").trim())&&!/^(\s*(?:-?\d+(?:\.\d+)?(?:px)?\s+-?\d+(?:\.\d+)?(?:px)?\s+(?:\d+(?:\.\d+)?(?:px)?\s+)?(?:\d+(?:\.\d+)?(?:px)?\s+)?(?:(?:rgb|hsl)a?\([^)]+\)|#?[a-z0-9]+))\s*,?\s*)+$/.test(e))return"function"==typeof window.tp__showCornerNotice&&window.tp__showCornerNotice(t,3e3),[{x:null,y:null,blur:null,spread:null,color:null,opacity:null}];const n=e.split(/,(?![^(]*\))/);await f(s);return n.map((e=>{const t=e.trim().replace(/\s{2,}/g," ").replace(/\s{0,},\s{0,}/g,",").split(" "),n=t.pop()||"",i=window.TColorPicker.parseColor(n),s=n&&!isNaN(i[3])&&i[3]!==p.opacity?i[3]:null;let o=n?"#"+window.TColorPicker.hslToHEX(i):null;o=o===p.color?null:o;const a={opacity:s,color:o};return["x","y","blur","spread"].forEach(((e,n)=>{const i=parseInt(t[n],10);a[e]=isNaN(i)||i===p[e]?null:i})),a}))}function k(e){const t=e=>{if(!e)return!1;const t=window.getComputedStyle(e),n=["auto","scroll"].includes(t.overflowX),i=["auto","scroll"].includes(t.overflowX),{offsetHeight:s,scrollHeight:o,offsetWidth:a,scrollWidth:l}=e;return l>a&&n||o>s&&i};e.addEventListener("wheel",(n=>{const{deltaX:i,deltaY:s,target:o}=n,a=(n=>{let i=n;for(;!t(i)&&(i=i.parentElement,i!==e&&i!==document.documentElement););return i})(o);let l;var r;l=Math.abs(i)>Math.abs(s)?"horizontal":Math.abs(i)<Math.abs(s)?"vertical":"both",(["vertical","both"].includes(l)&&((r=a)&&0===r.scrollTop&&s<0||(e=>e&&Math.ceil(e.scrollTop+e.clientHeight)>=e.scrollHeight)(a)&&s>0)||["horizontal","both"].includes(l)&&((e=>e&&0===e.scrollLeft)(a)&&i<0||(e=>e&&Math.ceil(e.scrollLeft+e.clientWidth)>=e.scrollWidth)(a)&&i>0))&&n.preventDefault()}),{passive:!1})}function E(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function x(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var S=new WeakSet;class T{constructor(e){E(this,S),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.props={options:Array.isArray(e.options)?e.options:[],value:"string"==typeof e.value?e.value:"",changeHandler:"function"==typeof e.changeHandler?e.changeHandler:function(){}}}render(){const e=this.props.options.map((e=>g`
                <option
                    value=${e.value}
                    selected=${e.value===this.props.value}
                    disabled=${!!e.disabled}
                >
                    ${e.label}
                </option>
            `));return this.element=g`
            <select
                className="tsp-panel__select"
                onChange=${[x(this,S,N).bind(this),this.props.changeHandler]}
            ></select>
        `,this.element.append(...e),x(this,S,N).call(this),this.element}set value(e){this.element.value=e,x(this,S,N).call(this)}}function N(){const e=this.element.selectedOptions[0],t=document.createElement("div");t.classList.add("tsp-select-helper"),t.innerText=e.innerText,document.body.appendChild(t),this.element.style.width=`${t.offsetWidth}px`,t.remove()}function C(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function L(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var D=new WeakSet;class W{constructor(e){C(this,D),this.props=e,this.props.updateTrigger.on(L(this,D,P).bind(this))}render(){return this.element=g`
            <div className="tsp-preview">
                <div className="tsp-preview__box" bindTo=${[this,"previewBox"]}></div>
            </div>
        `,L(this,D,P).call(this),this.element}}function P(){const e=y(this.props.settings);this.previewBox.style.boxShadow=e}function H(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function j(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var A=new WeakSet,I=new WeakSet,B=new WeakSet,O=new WeakSet,M=new WeakSet,z=new WeakSet;class R{constructor(e){H(this,z),H(this,M),H(this,O),H(this,B),H(this,I),H(this,A),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.props={label:_(e.label||"",e.lang),min:isNaN(e.min)?null:e.min,max:isNaN(e.max)?null:e.max,units:"string"==typeof e.units?e.units:"",factor:e.factor&&!isNaN(e.factor)?e.factor:null,placeholder:"string"==typeof e.placeholder?e.placeholder:"",isColor:!!e.isColor,isNumber:!!e.isNumber,isSingleLine:!!e.isSingleLine,value:e.value,name:e.name||"",inputHandler:"function"==typeof e.inputHandler?e.inputHandler:function(){},blurHandler:"function"==typeof e.blurHandler?e.blurHandler:function(){},isCopyButton:!!e.isCopyButton,isSelectOnFocus:!!e.isSelectOnFocus,colorPickers:e.colorPickers||[],theme:e.theme,lang:e.lang}}render(){const{isColor:e,isSingleLine:t,inputHandler:n,label:i,name:s,isCopyButton:o,lang:a}=this.props;return this.element=g`
            <label className="tsp-panel__input-label${t?" tsp-panel__input-label_line":""}">
                <span className="tsp-panel__input-span">${i}</span>
                <input
                    type="text"
                    className="tsp-panel__input"
                    placeholder=${this.props.placeholder}
                    onFocus=${j(this,I,K).bind(this)}
                    onBlur=${[j(this,B,X).bind(this),this.props.blurHandler]}
                    onKeydown=${j(this,O,U).bind(this)}
                    name=${s}
                    onInput=${e?void 0:n}
                    onColorchange=${e?n:void 0}
                    bindTo=${[this,"input"]}
                />
                <button
                    className="tsp-panel__input-btn${o?"":" tsp-panel__input-btn_hidden"}"
                    type="button"
                    tooltip=${_("copy",a)}
                    onClick=${j(this,z,q).bind(this)}
                    bindTo=${[this,"copyButton"]}
                ></button>
            </label>
        `,e?j(this,A,F).call(this):this.value=this.props.value,this.element}set value(e){if(null===e)return void(this.input.value="");e=String(e);const{units:t,isNumber:n,isColor:i,factor:s}=this.props;if(n){s&&(e*=s);e=j(this,M,Y).call(this,e)+t}i&&this.colorpicker?this.colorpicker.color=e:this.input.value=e}get value(){const{value:e}=this.input,{isNumber:t,isColor:n,factor:i}=this.props;if(!e&&!n)return null;if(t){let t=j(this,M,Y).call(this,e);return i&&(t/=i),t}if(n){if(!this.colorpicker||!this.colorpicker.color)return null;const e=this.colorpicker.color;return"#"+window.TColorPicker.hslToHEX(e)}return e}}function F(){const{theme:e,lang:t}=this.props;f(s).then((()=>{this.colorpicker=new window.TColorPicker(this.input,{...c,theme:e,lang:t}),this.colorpicker.init(),this.props.colorPickers.push(this.colorpicker),this.value=this.props.value})).catch((()=>{throw new Error("Error loading colorpicker")}))}function K(){const{isNumber:e,units:t,isSelectOnFocus:n}=this.props;n&&this.input.select();const{value:i}=this.input;if(!e||!t||!i)return;const s=parseInt(i,10)||0;this.input.value=s}function X(){const{isNumber:e,units:t}=this.props,{value:n}=this.input;if(!e||!n)return;const i=j(this,M,Y).call(this,n);this.input.value=i+(t||"")}function U(e){const{isNumber:t}=this.props;if(!t||!["ArrowUp","ArrowDown"].includes(e.key))return;e.preventDefault();const n=parseInt(this.input.value,10)||0,i="ArrowUp"===e.key?n+1:n-1,s=j(this,M,Y).call(this,i);this.input.value=s,this.input.dispatchEvent(new Event("input"))}function Y(e){const{min:t,max:n,isNumber:i}=this.props;if(!i)return;let s=parseInt(e,10)||0;return null!==t&&(s=Math.max(t,s)),null!==n&&(s=Math.min(n,s)),s}function q(){const{value:e}=this.input;navigator.clipboard.writeText(e),this.copyButton.classList.add("tsp-panel__input-btn_done"),window.clearTimeout(this.copyButton.copyTimeout),this.copyButton.copyTimeout=window.setTimeout((()=>{this.copyButton.classList.remove("tsp-panel__input-btn_done")}),1e3)}function G(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function J(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Q=new WeakSet;class V{constructor(e){G(this,Q),this.props=e,this.inputs=[]}render(){const{isExpanded:e,isDeleted:t}=this.props.settings,{lang:n}=this.props;if(t){const e=b(0,(Date.now()-this.props.settings.deleteTimestamp)/1e3/3,1),t=Math.round(3*(1-e));this.element=g`
                <div className="tsp-panel__layer">
                    <div
                        className="tsp-panel__layer-header tsp-panel__layer-header_deleted tsp-panel__section"
                        style=${`--time-shift:${e}; --delete-delay:3s;`}
                    >
                        <span className="tsp-panel__layer-deleted-span">${_("layer_deleted",n)}</span>
                        <button
                            type="button"
                            className="tsp-panel__layer-deleted-button"
                            onClick=${this.props.restoreHandler}
                        >
                            <svg className="tsp-panel__layer-deleted-circle" viewBox="0 0 14 14">
                                <circle r="6" cx="7" cy="7"></circle>
                            </svg>
                            <span className="tsp-panel__layer-deleted-counter" bindTo=${[this,"counterElement"]}>
                                ${t}
                            </span>
                            ${_("restore",n)}
                        </button>
                    </div>
                </div>
            `;const i=window.setInterval((()=>{const e=b(0,(Date.now()-this.props.settings.deleteTimestamp)/1e3/3,1),t=Math.round(3*(1-e));this.counterElement.innerText=t,t||window.clearInterval(i)}),50);return this.element}const i=u.map((e=>{const t=d[e];t.value=this.props.settings[e];const i=new R({...t,name:e,inputHandler:J(this,Q,Z).bind(this),colorPickers:this.props.colorPickers,theme:this.props.theme,lang:n});return this.inputs.push(i),i.render()}));return this.element=g`
            <div className="tsp-panel__layer${e?" tsp-panel__layer_expanded":""}">
                <div className="tsp-panel__layer-header tsp-panel__section">
                    <div className="tsp-panel__layer-handle"></div>
                    <button type="button" className="tsp-panel__layer-button" onClick=${this.props.expandHandler}>
                        ${_("layer",n)} ${this.props.settings.order}
                    </button>
                    <button
                        type="button"
                        className="tsp-panel__layer-delete"
                        onClick=${this.props.deleteHandler}
                        tooltip=${_("delete_layer",n)}
                    ></button>
                </div>
                <div className="tsp-panel__layer-inputs tsp-panel__section">${i}</div>
            </div>
        `,this.element}}function Z(e){const{name:t}=e.target,n=this.inputs.find((e=>{let{input:n}=e;return n.name===t}));if(!n)return;const i=n.value;this.props.settings[t]=i,this.props.updateTrigger&&this.props.updateTrigger.trigger()}function ee(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function te(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var ne=new WeakSet,ie=new WeakSet,se=new WeakSet,oe=new WeakSet,ae=new WeakSet,le=new WeakSet,re=new WeakSet,ce=new WeakSet;class he{constructor(e){ee(this,ce),ee(this,re),ee(this,le),ee(this,ae),ee(this,oe),ee(this,se),ee(this,ie),ee(this,ne),this.props=e}render(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.colorPickers.forEach((e=>e.destroy())),this.props.colorPickers.splice(0);const{settings:t,theme:n,lang:i}=this.props;return t.forEach(((s,o)=>{s.order=o+1,e&&1!==t.length||(s.isExpanded=o===t.length-1),s.element=g`
                <${V}
                    settings=${s}
                    updateTrigger=${this.props.updateTrigger}
                    deleteHandler=${te(this,oe,me).bind(this)}
                    restoreHandler=${te(this,le,we).bind(this)}
                    expandHandler=${te(this,re,fe).bind(this)}
                    colorPickers=${this.props.colorPickers}
                    theme=${n}
                    lang=${i}
                />
            `})),this.element=g`
            <div className="tsp-panel__layers${1===t.length?" tsp-panel__layers_single":""}">
                ${t.map((e=>{let{element:t}=e;return t}))}
                <div className="tsp-panel__section tsp-panel__layers-btn-wrapper">
                    <button type="button" className="tsp-panel__layers-btn" onClick=${te(this,se,ue).bind(this)}>
                        ${_("add_layer",i)}
                    </button>
                </div>
            </div>
        `,te(this,ne,pe).call(this),this.element}update(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.sortable&&this.sortable.destroy();const i=this.element,{scrollTop:s}=i;this.render(e),i.replaceWith(this.element),this.element.scrollTo(0,e?s:this.element.scrollHeight),n||this.props.updateTrigger.trigger(t)}}function pe(){const{theme:e}=this.props;this.props.settings.length<=1||("dark"===e&&(h.dragImage.className="tsp-panel__drag-image_dark"),f(a).then((()=>{this.sortable=new window.TSortableLite(this.element,{...h,onDrop:te(this,ie,de).bind(this)}).init()})))}function de(e){const{prevEl:t,nextEl:n}=e.relativeTargets,i=e.draggingElement,{settings:s}=this.props;if(!t&&!n||!i)return;const o=!!t,a=s.find((e=>{let{element:t}=e;return t===i})),l=s.find((e=>{let{element:i}=e;return i===(o?t:n)}));if(!a||!l)return;const r=s.indexOf(a);s.splice(r,1);const c=s.indexOf(l);s.splice(o?c+1:c,0,a),this.update(!0)}function ue(){const{settings:e}=this.props,t={...e[e.length-1]||te(this,ce,ve).call(this)};Object.keys(t).forEach((e=>{u.includes(e)||delete t[e],"x"!==e&&"y"!==e||!t[e]||(t[e]*=-1)})),e.push(t),this.update()}function me(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=t.find((e=>{let{element:t}=e;return t===n}));i.isDeleted=!0,i.deleteTimestamp=Date.now(),i.deleteTimeout=window.setTimeout(te(this,ae,ge).bind(this,i),3e3),this.update(!0)}function ge(e){const{settings:t}=this.props,n=t.indexOf(e);-1!==n&&(t.splice(n,1),t.length||t.push(te(this,ce,ve).call(this)),this.update(!0,!1,!0))}function we(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=t.find((e=>{let{element:t}=e;return t===n}));window.clearTimeout(i.deleteTimeout),delete i.deleteTimeout,delete i.isDeleted,delete i.deleteTimestamp,this.update(!0)}function fe(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=n.classList.contains("tsp-panel__layer_expanded"),s=t.find((e=>{let{element:t}=e;return t===n}));if(i)s.isExpanded=!1,n.classList.remove("tsp-panel__layer_expanded");else{const e=t.find((e=>{let{isExpanded:t}=e;return t}));e&&(e.isExpanded=!1,e.element.classList.remove("tsp-panel__layer_expanded")),s.isExpanded=!0,n.classList.add("tsp-panel__layer_expanded")}}function ve(){const e={};return u.forEach((t=>e[t]=null)),e}function ye(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function be(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var _e=new WeakSet,$e=new WeakSet,ke=new WeakSet,Ee=new WeakSet,xe=new WeakSet,Se=new WeakSet,Te=new WeakSet;class Ne{constructor(e){ye(this,Te),ye(this,Se),ye(this,xe),ye(this,Ee),ye(this,ke),ye(this,$e),ye(this,_e),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.settings=e.settings,this.initialShadow=y(this.settings),this.closeHandler="function"==typeof e.closeHandler?e.closeHandler:function(){},this.relatedElement=e.relatedElement,this.editButton=e.editButton,this.shadowChangeTrigger=e.shadowChangeTrigger,this.colorPickers=[],this.theme=e.theme,this.altNoLabel=e.altNoLabel,this.lang=e.lang,this.handleDocClick=this.handleDocClick.bind(this),this.handleDocKeyDown=this.handleDocKeyDown.bind(this),this.handleDocPointerDown=this.handleDocPointerDown.bind(this),this.handleTransitionEnd=this.handleTransitionEnd.bind(this),this.updateTrigger=w(),this.updateTrigger.on(be(this,Ee,We).bind(this))}render(){const{lang:e}=this;this.cssInput=new R({label:"css",isSingleLine:!0,value:y(this.settings),blurHandler:be(this,xe,Pe).bind(this),inputHandler:be(this,xe,Pe).bind(this),isCopyButton:!0,isSelectOnFocus:!0,lang:e}),this.layersCollection=new he({settings:this.settings,updateTrigger:this.updateTrigger,colorPickers:this.colorPickers,theme:this.theme,lang:this.lang});const t=r.map((t=>{let n="";t.custom?n="custom":t.empty||(n=y(t));return{value:n,label:_("none"===t.label&&this.altNoLabel?"default":t.label,e),disabled:t.custom}}));let n=y(this.settings);return n=t.find((e=>{let{value:t}=e;return t===n}))?n:"custom",this.select=new T({value:n,options:t,changeHandler:be(this,Se,He).bind(this)}),this.element=g`
            <div className="tsp-panel tsp-panel_hidden${"dark"===this.theme?" tsp-panel_dark":""}">
                <div className="tsp-panel__section tsp-panel__header">
                    ${this.select.render()}
                    <button className="tsp-panel__header-btn" onClick=${be(this,$e,Le).bind(this)}></button>
                </div>
                <${W} updateTrigger=${this.updateTrigger} settings=${this.settings} />
                ${this.layersCollection.render()}
                <div className="tsp-panel__section tsp-panel__footer">${this.cssInput.render()}</div>
            </div>
        `,k(this.element),be(this,_e,Ce).call(this),this.element}handleTransitionEnd(){this.element.remove(),this.element.removeEventListener("transitionend",this.handleTransitionEnd)}handleDocClick(e){const t=this.colorPickers.some((e=>e&&e.panelState));this.element.contains(e.target)||e.target.closest("#confirm-dialog")||this.editButton.contains(e.target)||t||this.isPointerDownOnPanel?this.isPointerDownOnPanel=!1:be(this,$e,Le).call(this)}handleDocKeyDown(e){const t=this.colorPickers.some((e=>e&&e.panelState));"Escape"!==e.key||t||document.querySelector("#confirm-dialog")||be(this,$e,Le).call(this)}handleDocPointerDown(e){this.isPointerDownOnPanel=this.element.contains(e.target)}}function Ce(){document.body.contains(this.element)||(be(this,ke,De).call(this),document.addEventListener("click",this.handleDocClick),document.addEventListener("keydown",this.handleDocKeyDown),document.addEventListener("pointerdown",this.handleDocPointerDown),window.setTimeout((()=>{this.element.classList.remove("tsp-panel_hidden")}),0))}function Le(){document.body.contains(this.element)&&(document.removeEventListener("click",this.handleDocClick),document.removeEventListener("keydown",this.handleDocKeyDown),document.removeEventListener("pointerdown",this.handleDocPointerDown),this.layersCollection.sortable&&this.layersCollection.sortable.destroy(),this.closeHandler(),this.element.addEventListener("transitionend",this.handleTransitionEnd),this.element.classList.add("tsp-panel_hidden"))}function De(){if(!(this.relatedElement instanceof Element))return;const{top:e,height:t,left:n,width:i}=this.relatedElement.getBoundingClientRect(),{clientWidth:s,clientHeight:o}=document.documentElement,a=-200,l=o-e-t-a-5>=550,r=s-n-i-10-5>=225,c=n-10-5>=225;let h="0px",p="0px";r||!l&&!r&&!c?(h=`${n+i+10}px`,p=`${e+a}px`):l?(h=`${n}px`,p=`${e+t+a}px`):c&&(h=`calc(${n-10}px - 100%)`,p=`${e+a}px`),this.element.style.setProperty("--pos-x",h),this.element.style.setProperty("--pos-y",p)}function We(e){const t=y(this.settings);e||(this.cssInput.value=t);const n=[...this.select.element.options].find((e=>{let{value:n}=e;return n===t}));this.select.value=n?n.value:"custom",this.shadowChangeTrigger.trigger(t)}function Pe(e){const{value:t}=this.cssInput;be(this,Te,je).call(this,t,"input"===e.type)}function He(){const{value:e}=this.select.element;be(this,Te,je).call(this,e)}async function je(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=_("invalid_shadow",this.lang),i=await $(e,n);this.settings.splice(0,this.settings.length),this.settings.push(...i),this.layersCollection.update(!1,t,!0),this.updateTrigger.trigger(t)}class Ae extends CustomEvent{constructor(e){super("paneltoggle"),this.isOpen=e}}function Ie(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Be(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Oe=new WeakSet,Me=new WeakSet,ze=new WeakSet,Re=new WeakSet,Fe=new WeakSet,Ke=new WeakSet,Xe=new WeakSet,Ue=new WeakSet,Ye=new WeakSet,qe=new WeakSet;function Ge(){this.select=Be(this,Me,Je).call(this);const{theme:e,lang:t}=this.config;this.container=g`
            <div className="tsp${"dark"===e?" tsp_dark":""}">
                ${this.select}
                <button
                    type="button"
                    className="tsp__edit"
                    onClick=${Be(this,Ue,nt).bind(this)}
                    bindTo=${[this,"editButton"]}
                >
                    ${_("edit",t)}
                </button>
            </div>
        `,this.noActionLayer=g`
            <div className="tsp__noaction"></div>
        `,this.input.after(this.container),this.input.type="hidden",this.container.append(this.input),Be(this,Fe,Ze).call(this)}function Je(){const e=g`
            <select className="tsp__select" onInteraction=${Be(this,Ke,et).bind(this)}></select>
        `,t=Be(this,ze,Qe).call(this);return e.append(...t),e}function Qe(){const e=this.input.value,t=r.map((e=>y(e))).some((t=>t===e)),{altNoLabel:n,lang:i}=this.config;return t||(this.previousInitialShadow=e),r.map((s=>{let o="";s.custom?o="custom":s.empty||(o=y(s));const a=_("none"===s.label&&n?"default":s.label,i);return g`
                <option
                    value=${o}
                    data-img=${s.img}
                    selected=${o===e||s.custom&&!t}
                >
                    ${s.custom&&this.previousInitialShadow?this.previousInitialShadow:a}
                </option>
            `}))}function Ve(){this.select.innerHTML="";const e=Be(this,ze,Qe).call(this);this.select.append(...e),this.previewBox&&this.previewBox.update()}function Ze(){const{theme:e,height:t}=this.config;f(o).then((()=>{this.previewBox=new window.TPreviewbox(this.select,{theme:e,height:t})})).catch((()=>{throw new Error("Fail to load previewbox")}))}function et(){const e=this.select.value;this.input.value="custom"===e?this.previousInitialShadow:e,this.input.dispatchEvent(new Event("change")),Be(this,Re,Ve).call(this),"custom"===e&&Be(this,Xe,tt).call(this,this.previousInitialShadow)}async function tt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isPanelRendered)return;const{theme:t,lang:n}=this.config,i=_("invalid_shadow",n),s=await $(e,i),{altNoLabel:o}=this.config;document.body.append(g`
            <${Ne}
                settings=${s}
                relatedElement=${this.container.querySelector(".tprev")||this.container}
                closeHandler=${Be(this,Ye,it).bind(this)}
                shadowChangeTrigger=${this.shadowChangeTrigger}
                editButton=${this.editButton}
                theme=${t}
                altNoLabel=${o}
                lang=${n}
            />
        `),this.isPanelRendered=!0,document.body.append(this.noActionLayer),this.input.dispatchEvent(new Ae(!0))}function nt(){Be(this,Xe,tt).call(this,this.input.value)}function it(){this.isPanelRendered=!1,this.noActionLayer.remove(),this.input.dispatchEvent(new Ae(!1))}function st(e){this.input.value=e,this.input.dispatchEvent(new Event("change")),Be(this,Re,Ve).call(this)}window.TShadowPicker=class{constructor(e,t){if(Ie(this,qe),Ie(this,Ye),Ie(this,Ue),Ie(this,Xe),Ie(this,Ke),Ie(this,Fe),Ie(this,Re),Ie(this,ze),Ie(this,Me),Ie(this,Oe),!(e instanceof HTMLInputElement))throw new TypeError("Input must be an instance of HTMLInputElement");t="[object Object]"===Object.prototype.toString.call(t)?t:{};let i="EN";const s=Object.keys(n);s.includes(t.lang)?i=t.lang:s.includes(window.lang)&&(i=window.lang),this.config={shadowChangeDelay:!isNaN(t.shadowChangeDelay)&&t.shadowChangeDelay>=0?t.shadowChangeDelay:50,theme:["light","dark"].includes(t.theme)?t.theme:"light",height:!isNaN(t.height)&&t.height>0?t.height:40,altNoLabel:!!t.altNoLabel,lang:i},this.input=e,this.isPanelRendered=!1,this.previousInitialShadow="",this.shadowChangeTrigger=w(),this.shadowChangeTrigger.on(function(e,t){let n=null;return function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];n||(n=window.setTimeout((()=>{e.apply(null,s),window.clearTimeout(n),n=null}),t))}}(Be(this,qe,st).bind(this),this.config.shadowChangeDelay)),Be(this,Oe,Ge).call(this)}}})();