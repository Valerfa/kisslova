function tc__treelist__drawPagesList(l,e,t,i,s){if(!e||0===e.length||void 0===e.length)return'<div class="tc-treelist__pagelist__no-pages-in-project">'+("em"===l.kind?"{{no_emails_yet}}":"{{no_pages_yet}}")+"</div>";const _="edrec__popup__pageslist"===i?"lite":"pe__pageslist"===i?"index":"default";var r,a={},o=(e.forEach(function(e){e.id===l.headerpageid?a.headerPage=e:e.id===l.footerpageid?a.footerPage=e:e.id===l.page404id&&(a.page404=e)}),a.services=l.specialpages?e.filter(e=>e.id in l.specialpages&&e.id!==l.headerpageid&&e.id!==l.footerpageid):[],"");return t&&0<t.length&&(o+=tc__treelist__drawFoldersList({folders:t,pages:e,project:l,wrapperClass:i,mode:_,selectedPagesId:s})),e.forEach(function(e){"0"!==e.folderid||""!==e.trash||l.headerpageid===e.id||l.footerpageid===e.id||l.page404id===e.id||l.specialpages&&(!l.specialpages||e.id in l.specialpages)||(e={page:e,currentpageid:window.pageid,indexpageid:l.indexpageid,wrapperClass:i,mode:_,selectedPagesId:s},o+=tc__treelist__drawPage(e))}),["lite","index"].includes(_)||(r={currentpageid:window.pageid,indexpageid:l.indexpageid,wrapperClass:i,mode:_},a.headerPage&&(r.page=a.headerPage,r.specialPage="header",r.title="Header",l.specialpages&&a.headerPage.id in l.specialpages&&l.specialpages[a.headerPage.id].header&&(r.title+=" [{{service_title_site}}] "+l.specialpages[a.headerPage.id].header.map(e=>`[{{service_title_${e}}}]`).join(" ")),o+=tc__treelist__drawPage(r)),a.footerPage&&(r.page=a.footerPage,r.specialPage="footer",r.title="Footer",l.specialpages&&a.footerPage.id in l.specialpages&&l.specialpages[a.footerPage.id].footer&&(r.title=" [{{service_title_site}}] "+l.specialpages[a.footerPage.id].footer.map(e=>`[{{service_title_${e}}}]`).join(" ")),o+=tc__treelist__drawPage(r)),a.services.forEach(i=>{r.page=i,r.title="",Object.entries(l.specialpages[i.id]).reverse().map(([e,t])=>{r.specialPage=l.specialpages[i.id].header&&l.specialpages[i.id].footer?"header":e,e=""+e[0].toUpperCase()+e.slice(1),r.title+=`${e} ${t.map(e=>`[{{service_title_${e}}}]`).join(" ")} `}),o+=tc__treelist__drawPage(r)}),a.page404&&(r.page=a.page404,r.specialPage="404",o+=tc__treelist__drawPage(r))),o}function tc__treelist__drawFoldersList({folders:e,pages:i,project:l,wrapperClass:t,mode:s,selectedPagesId:_}){const{id:r,indexpageid:a,kind:o}=l;e.forEach(function(t){t.id==window.folderid&&(t.isCurrent=!0),t.pages=[],i.forEach(function(e){e.folderid!==t.id||l.specialpages&&(!l.specialpages||e.id in l.specialpages)||(t.pages.push(e),e.id==window.pageid&&(t.isCurrent=!0))})});var c={"tc-sidebar":22,edrec__popup__pageslist:47,index:60,default:36};const n=c[t]||c.default;var p="";const d={lite:tc__treelist__getLiteFolderHTML,index:tc__treelist__getIndexFolderHTML,default:tc__treelist__getDefaultFolderHTML};return e.forEach(function(e){var t;""===e.trash&&(t=`/projects/?projectid=${r}&folderid=`+e.id,e={folder:e,projectId:r,indexpageid:a,mode:s,charsLimit:n,folderLink:t,projectKind:o,selectedPagesId:_},p+=d[s](e))}),p}function tc__treelist__getLiteFolderHTML(e){const{folder:t,projectId:i,indexpageid:l,mode:s,charsLimit:_,projectKind:r}=e;let a="";return a+=`<div
		class="tc-treelist__pagelist__folder tc-treelist__sort__item
			${t.isCurrent?" tc-treelist__pagelist__folder_current js-treelist-opened-folder":""}
		"
		data-folderid="${t.id}"
	>
		<div
			class="tc-treelist__folder__title-wrapper
				${t.title.length>_?" tc-treelist__folder__title_long":""}
			"
			draggable="true"
			tabindex="0"
		>
			<span
				class="tc-treelist__arrow
					${t.isCurrent?" tc-treelist__arrow_opened":""}
			"></span>
			<span class="tc-treelist__folder__title ${t.title.length>_?` tc-treelist__tooltip" title="${t.title}"`:'"'}>
				${t.title}
			</span>
		</div>
		<div
			class="tc-treelist__page-list-folder__pages
				${t.isCurrent?" tc-treelist__page-list-folder__pages_opened":""}
				tc-treelist__page__sortable-container"
			data-projectid="${i}"
			data-folderid="${t.id}">`,t.pages&&0<t.pages.length&&t.pages.forEach(function(e){e={currentpageid:window.pageid,page:e,indexpageid:l,mode:s};a+=tc__treelist__drawPage(e)}),a+=`<div
			class="tc-treelist__folder__no-pages
				${t.pages&&0<t.pages.length?" tc-treelist__folder__no-pages_hidden":""}
			">
			${"em"===r?"{{no_emails_yet}}":"{{no_pages_yet}}"}
		</div>
	</div>
</div>`}function tc__treelist__getIndexFolderHTML(e){const{folder:t,projectId:i,indexpageid:l,mode:s,charsLimit:_,projectKind:r,selectedPagesId:a}=e;let o="";return o+=`<div
		class="tc-treelist__pagelist__folder tc-treelist__sort__item
			${t.isCurrent?" tc-treelist__pagelist__folder_current js-treelist-opened-folder":""}
		"
		data-folderid="${t.id}"
	>
		<div
			class="tc-treelist__folder__title-wrapper
				${t.title.length>_?" tc-treelist__folder__title_long":""}
			"
			tabindex="0"
		>
			<label class="pe-label-checkbox-custom">
				<input
					type="checkbox"
					name=""pageslist_allfolder"
					value="${t.id}"
					class="pe-input-checkbox chbx pe-pageslist__checkbox pe-pageslist__checkbox__allfolder"
					data-skip=true
				/>
				<span class="pe-checkbox-custom_filled">
					<svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
						<path d="M3 8.08333L6.6 11L12 4" vector-effect="non-scaling-stroke" />
					</svg>
				</span>
			</label>
			<span
				class="tc-treelist__arrow
					${t.isCurrent?" tc-treelist__arrow_opened":""}
			"></span>
			<span class="tc-treelist__folder__title ${t.title.length>_?` tc-treelist__tooltip" title="${t.title}"`:'"'}>
				${t.title}
			</span>
		</div>
		<div
			class="tc-treelist__page-list-folder__pages
				${t.isCurrent?" tc-treelist__page-list-folder__pages_opened":""}
				tc-treelist__page__sortable-container"
			data-projectid="${i}"
			data-folderid="${t.id}">`,t.pages&&Array.isArray(t.pages)&&t.pages.forEach(function(e){e={currentpageid:window.pageid,page:e,indexpageid:l,mode:s,selectedPagesId:a};o+=tc__treelist__drawPage(e)}),o+=`<div
			class="tc-treelist__folder__no-pages
				${t.pages&&0<t.pages.length?" tc-treelist__folder__no-pages_hidden":""}
			">
			${"em"===r?"{{no_emails_yet}}":"{{no_pages_yet}}"}
		</div>
	</div>
</div>`}function tc__treelist__getDefaultFolderHTML(e){const{folder:t,projectId:i,indexpageid:l,mode:s,charsLimit:_,projectKind:r,folderLink:a}=e;let o="";return o+=`<div
		class="tc-treelist__pagelist__folder tc-treelist__sort__item
			${t.isCurrent?" tc-treelist__pagelist__folder_current js-treelist-opened-folder":""}
		"
		data-folderid="${t.id}"
	>
		<div
			class="tc-treelist__folder__title-wrapper
				${t.title.length>_?" tc-treelist__folder__title_long":""}
			"
			draggable="true"
			tabindex="0"
		>
			<span
				class="tc-treelist__arrow
					${t.isCurrent?" tc-treelist__arrow_opened":""}
			"></span>
			<a href="${a}" class="tc-treelist__folder__title ${t.title.length>_?` tc-treelist__tooltip" title="${t.title}"`:'"'}>
				${t.title}
			</a>
		</div>
		<div
			class="tc-treelist__page-list-folder__pages
				${t.isCurrent?" tc-treelist__page-list-folder__pages_opened":""}
				tc-treelist__page__sortable-container"
			data-projectid="${i}"
			data-folderid="${t.id}">`,t.pages&&Array.isArray(t.pages)&&t.pages.forEach(function(e){e={currentpageid:window.pageid,page:e,indexpageid:l,mode:s};o+=tc__treelist__drawPage(e)}),o+=`<div
			class="tc-treelist__folder__no-pages
				${t.pages&&0<t.pages.length?" tc-treelist__folder__no-pages_hidden":""}
			">
			${"em"===r?"{{no_emails_yet}}":"{{no_pages_yet}}"}
		</div>
	</div>
</div>`}function tc__treelist__drawPage(e){var t=""!==e.page.published,i=e.page.published<e.page.changed,l=e.indexpageid===e.page.id,s=e.page.id==e.currentpageid;let _="",r="",a=(t?i?(_="tc-treelist__page_changed",r="{{changes_not_published}}"):_="tc-treelist__page_unchanged":(_="tc-treelist__page_unpublished",r="{{page_not_published}}"),"tc-treelist__page__icon");l?a+=" tc-treelist__page__icon_index":"header"===e.specialPage?a+=" tc-treelist__page__icon_header":"footer"===e.specialPage?a+=" tc-treelist__page__icon_footer":"404"===e.specialPage&&(a+=" tc-treelist__page__icon_404");var t={"tc-sidebar":21,edrec__popup__pageslist:47,index:65,default:30},i=t[e.wrapperClass]||t.default,i="0"===e.page.folderid||e.specialPage?i:i-9,t=e.page.title,l=("header"===e.specialPage||"footer"===e.specialPage?(t=e.title,t="tc-sidebar"===e.wrapperClass?tc__sidebar__translate(t):tc__translate(t,"page__dict")):"404"===e.specialPage?t="{{error_404}}":"lite"===e.mode&&s?t+=" [{{current_page}}]":"lite"===e.mode&&l&&(t+=" [{{home_page}}]"),`/page/?pageid=${e.page.id}&projectid=`+e.page.projectid),o=e.page.alias,c=e.indexpageid===e.page.id?"":`page${e.page.id}.html`,n=tc__treelist__getAbsolutePublishLinkHref(o||c),p={lite:tc__treelist__getLitePageHTML,index:tc__treelist__getIndexPageHTML,default:tc__treelist__getDefaultPageHTML};return p[e.mode]?(s={options:e,isCurrentPage:s,pageLink:l,linkTitle:t,publishStatusClass:_,publishStatusHint:r,iconClasses:a,charsLimit:i,aliasLink:o,publishPageRelativeLink:c,publishPageAbsoluteLink:n,publishLink:"/"+(o||c)},p[e.mode](s)):""}function tc__treelist__getLitePageHTML(e){var{options:e,isCurrentPage:t,linkTitle:i,iconClasses:l,charsLimit:s,aliasLink:_,publishPageRelativeLink:r,publishPageAbsoluteLink:a,publishLink:o}=e,l=`
		<span
			class="tc-treelist__page__title
				${t?" tc-treelist__page__title_current":""}"
			tabindex="0"
		>
			<div class="${l}"></div>
			<div class="tc-treelist__page__name__wrapper">
				<span
					class="tc-treelist__page__name${i.length>s?" tc-treelist__tooltip tc-treelist__page__name_long":""}"
					${i.length>s?`title="${i}"`:""}
					${e.specialPage?`data-title="${e.page.title}"`:""}
				>${i}</span>
				<span class="tc-treelist__page__url js-pagelist-url${o.length>s?" tc-treelist__tooltip tc-treelist__page__name_long":""}"
					${o.length>s?`title="${o}"`:""}>
					${o}
				</span>
			</div>
		</span>`;return`
		<div
			class="tc-treelist__page tc-treelist__page_lite
				${t?" tc-treelist__page_current":""}
				${e.indexpageid===e.page.id?" js-treelist-index-page":""}
				${e.specialPage?" js-treelist-special-page":""}
				"
			data-pageid="${e.page.id}"
			data-projectid="${e.page.projectid}"
			data-folderid="${e.page.folderid}"
			${e.page.alias?`data-url="${_||r}"`:""}
		>
			${l}
			${`
		<div class="tc-treelist__page__options">
			<a
				class="tc-treelist__page__option tc-treelist__page-link tc-treelist__tooltip"
				href="${a}"
				target="_blank"
				rel="noopener noreferrer"
				title="{{open_link_in_new_tab}}"
			></a>
		</div>`}
		</div>`}function tc__treelist__getIndexPageHTML(e){var{options:e,isCurrentPage:t,linkTitle:i,publishStatusClass:l,iconClasses:s,charsLimit:_,aliasLink:r,publishPageAbsoluteLink:a,publishPageRelativeLink:o,publishLink:c}=e,n=!!e.selectedPagesId&&e.selectedPagesId.includes(parseInt(e.page.id,10));return`
		<label
			class="tc-treelist__page tc-treelist__page_index
				${t?" tc-treelist__page_current":""}
				${l?" "+l:""}
				${e.indexpageid===e.page.id?" js-treelist-index-page":""}
				${e.specialPage?" js-treelist-special-page":""}
				pe-label-checkbox-custom
			"
			data-pageid="${e.page.id}"
			data-projectid="${e.page.projectid}"
			data-folderid="${e.page.folderid}"
			${e.page.alias?`data-url="${r||o}"`:""}
			tabindex="0"
		>
			<input
				class="pe-input-checkbox chbx pe-pageslist__checkbox"
				type="checkbox"
				name="pageslist${e.page.id}"
				${n?"checked":""}
			>
			<span class="pe-checkbox-custom_filled">
				<svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
					<path d="M3 8.08333L6.6 11L12 4" vector-effect="non-scaling-stroke" />
				</svg>
			</span>
			<div class="tc-treelist__page__name__wrapper">
				<div class="${s}"></div>
				<span
					class="tc-treelist__page__name${i.length>_?" tc-treelist__tooltip tc-treelist__page__name_long":""}"
					${i.length>_?`title="${i}"`:""}
					${e.specialPage?`data-title="${e.page.title}"`:""}
				>${i}</span>
			</div>
			<div class="tc-treelist__page__url__wrapper">
				<a href="${a}" target="_blank" class="tc-treelist__page__url js-pagelist-url${c.length>_?" tc-treelist__tooltip tc-treelist__page__name_long":""}"
					${c.length>_?`title="${c}"`:""}>
					${c}
				</a>
			</div>
			<div class="tc-treelist__page__options">
				<div
					class="tc-treelist__page__option tc-treelist__setting__button tc-treelist__tooltip"
					title="{{open_page_settings}}"
					onclick="event.preventDefault(); tc__treelist__showPageSettings('${e.page.id}')">${td__other__getIcon("settings")}
				</div>
				<a
					class="tc-treelist__page__option tc-treelist__page-link tc-treelist__tooltip"
					href="${a}"
					target="_blank"
					rel="noopener noreferrer"
					title="{{open_link_in_new_tab}}"
				></a>
			</div>
		</label>`}function tc__treelist__getDefaultPageHTML(e){var{options:e,isCurrentPage:t,pageLink:i,linkTitle:l,publishStatusClass:s,publishStatusHint:_,iconClasses:r,charsLimit:a,aliasLink:o,publishPageRelativeLink:c}=e,i=`<a
			class="tc-treelist__page__title
				${t?" tc-treelist__page__title_current":""}"
			href="${i}"
			${e.specialPage?' draggable="false"':""}
		>
			<div
				class="${r}${_?" tc-treelist__tooltip":""}"
				${_?` title="${_}"`:""}
			></div>
			<span
				class="tc-treelist__page__name
					${l.length>a?" tc-treelist__tooltip tc-treelist__page__name_long":""}"
					${l.length>a?`title="${l}"`:""}
					${e.specialPage?`data-title="${e.page.title}"`:""}
				>${l}
			</span>
		</a>`,r=`<div class="tc-treelist__page__options">
			<div
				class="tc-treelist__page__option tc-treelist__setting__button tc-treelist__tooltip"
				title="{{open_page_settings}}"
				onclick="tc__treelist__showPageSettings('${e.page.id}')">${td__other__getIcon("settings")}
			</div>
		</div>`;return`
		<div
			class="tc-treelist__page tc-treelist__sort__item
				${t?" tc-treelist__page_current":""}
				${s?" "+s:""}
				${e.indexpageid===e.page.id?" js-treelist-index-page":""}
				${e.specialPage?" js-treelist-special-page":""}
				"
			data-pageid="${e.page.id}"
			data-projectid="${e.page.projectid}"
			data-folderid="${e.page.folderid}"
			${e.page.alias?`data-url="${o||c}"`:""}
			draggable="true"
		>
			${i}
			${r}
		</div>`}function tc__treelist__getAbsolutePublishLinkHref(e){var{projectid:t,projectalias:i,projectcustomdomain:l,domainZone:s}=window,s=s||"ws";let _=l?"http://"+l:i?`http://${i}.tilda.`+s:`http://project${t}.tilda.`+s;return _+"/"+e}function tc__treelist__toggleFolder(e){var e=e.target.closest(".tc-treelist__pagelist__folder"),t=e.querySelector(".tc-treelist__arrow"),i=e.querySelector(".tc-treelist__page-list-folder__pages"),i=(e.classList.toggle("js-treelist-opened-folder"),t.classList.toggle("tc-treelist__arrow_opened"),i&&i.classList.toggle("tc-treelist__page-list-folder__pages_opened"),t.closest("[data-sortable-id]"));i&&(i=i.getAttribute("data-sortable-id"),window.sortables.get(i).update()),t.classList.contains("tc-treelist__arrow_opened")||window.tc__treelist__multiple&&window.tc__treelist__multiple.init&&window.tc__treelist__multiple.folderid===e.getAttribute("data-folderid")&&tc__treelist__multiple__clearSelection(e)}function tc__treelist__addTSortable(e){"function"==typeof TSortable?tc__treelist__initTSortable(e):"function"==typeof tc__connectTSortable&&tc__connectTSortable(function(){tc__treelist__initTSortable(e)})}function tc__treelist__initTSortable(e){e=e.querySelectorAll(".js-treelist-container");Array.prototype.forEach.call(e,function(e){var t=new TSortable(e,{selector:".tc-treelist__sort__item",handleSelector:".tc-treelist__sort__item",multipleSelector:".tc__treelist__multiple_selected",isAutoUpdateEnabled:!0,cancelSelector:".js-treelist-special-page",noAfterSelector:".js-treelist-special-page",specificSelector:".tc-treelist__pagelist__folder",dragImage:{className:"tc-treelist__drag-image",offset:0,maxWidth:210},dropBar:{className:"tc-treelist__dropbar",visibleClassName:"tc-treelist__dropbar_visible",vIndent:0},dropArea:{className:"tc-treelist__droparea",visibleClassName:"tc-treelist__droparea_visible"},toleranceDistance:10,delay:400,onStart:function(e){e=e.draggingElements[0];window.tc__treelist__initSortWrapper=e.closest(".tc-treelist__page__sortable-container")?e.closest(".tc-treelist__page__sortable-container"):e.closest(".js-treelist-container")},onBeforeDrop:function(e){var t=e.draggingElements[0],i=e.relativeTargets,l=i.prevEl,s=i.nextEl,_=t.classList.contains("tc-treelist__pagelist__folder"),r=l&&l.classList.contains("tc-treelist__pagelist__folder"),a=s&&s.classList.contains("tc-treelist__pagelist__folder"),t=t.classList.contains("js-treelist-index-page"),i=i.parentEl&&i.parentEl.classList.contains("tc-treelist__pagelist__folder")||l&&l.closest(".tc-treelist__pagelist__folder")&&s&&s.closest(".tc-treelist__pagelist__folder");t&&i&&(alert("This page is set as a Home Page and cannot be moved to any folder"),e.preventDefault()),_&&l&&!r&&e.preventDefault(),!_&&a&&e.preventDefault()},onDrop:function(e){var t,i,l,s,_,r,a,o,c;e.draggingElements[0].classList.contains("tc-treelist__pagelist__folder")?(t=e.draggingElements[0],setTimeout(function(){tc__treelist__saveSort("folder",t.closest(".js-treelist-container"))},1e3)):(i=window.tc__treelist__initSortWrapper,o=(_=e.relativeTargets).prevEl,c=_.nextEl,a=_.parentEl,r=e.draggingElements[0],l=_.parentEl&&a.classList.contains("tc-treelist__pagelist__folder")||o&&o.closest(".tc-treelist__pagelist__folder")&&c&&c.closest(".tc-treelist__pagelist__folder")?r.closest(".tc-treelist__page__sortable-container"):r.closest(".js-treelist-container"),s=l.getAttribute("data-folderid")||"0",_=i.getAttribute("data-folderid")||"0",a=i.querySelectorAll(".tc-treelist__page"),(o=i.querySelector(".tc-treelist__folder__no-pages"))&&(0===a.length?o.classList.remove("tc-treelist__folder__no-pages_hidden"):o.classList.add("tc-treelist__folder__no-pages_hidden")),c=l.querySelectorAll(".tc-treelist__page"),(r=l.querySelector(".tc-treelist__folder__no-pages"))&&(0===c.length?r.classList.remove("tc-treelist__folder__no-pages_hidden"):r.classList.add("tc-treelist__folder__no-pages_hidden")),window.tc__treelist__multiple&&window.tc__treelist__multiple.init&&window.tc__treelist__multiple.folderid&&_==window.tc__treelist__multiple.folderid&&tc__treelist__multiple__clearSelection(l),i!=l&&"/page/"===window.location.pathname&&i!=l&&(a=e.draggingElements.filter(function(e){return e.classList.contains("tc-treelist__page_current")})).length&&(o=document.querySelector(".tp-menu__folder"),"0"==s?(delete window.folderid,delete window.foldertitle):(c=a[0].closest(".tc-treelist__pagelist__folder").querySelector(".tc-treelist__folder__title").getAttribute("title"),window.folderid=s,window.foldertitle=c),o)&&(o.innerHTML=tp__menu__draw__breadcrumbs_folder()),setTimeout(function(){i!=l&&Array.prototype.forEach.call(e.draggingElements,function(e){tc__treelist__movePagetoFolder(e.getAttribute("data-pageid"),s),e.setAttribute("data-folderid",s)}),tc__treelist__saveSort("page",l)},1e3))},onExpand:function(e){e.preventDefault();var t=e.targetEl.querySelector(".tc-treelist__arrow");e.target.classList.contains("js-treelist-opened-folder")||tc__treelist__toggleFolder({target:t})},nested:{isEnabled:!0,containerTagName:"div",containerClassName:"tc-treelist__page-list-folder__pages",noNestedSelector:".tc-treelist__page",noDropInsideSelector:".tc-treelist__pagelist__folder",isExpandEnabled:!0,expandedClassName:"js-treelist-opened-folder",noExpandSelector:".tc-treelist__page"}}),i=(t.init(),String(performance.now()));e.setAttribute("data-sortable-id",i),window.sortables||(window.sortables=new Map),window.sortables.set(i,t)})}function tc__treelist__ajax__getSidebar(e,i){tc__treelist__ajax({url:"/projects/get/getsidebar/",dataToSend:e,ui:{ctext:"getting pages list",isQuiet:!0},onSuccess:function(e){if(check_logout(e),""===e)td__showBubbleNotice("Error. Request response is empty. Please reload the page and try again.",6e3,"error");else{try{var t=JSON.parse(e)}catch(e){console.log("json parse error")}"object"==typeof t?i(t):td__showBubbleNotice("Request error. "+e,6e3,"error")}}})}function tc__treelist__movePagetoFolder(e,t){e={pageid:e,csrf:getCSRF()};"0"==t?e.comm="movepagetorootfolder":(e.comm="movepagetofolder",e.folderid=t),tc__treelist__ajax({url:"/projects/submit/",dataToSend:e,ui:{ctext:"move page to folder"},onSuccess:function(e){""!=e&&"OK"!=e||check_logout(e)}})}function tc__treelist__saveSort(e,t){var i={},l="",s=!1;switch(e){case"page":var _=t.querySelectorAll(".tc-treelist__page"),r="data-pageid";i.comm="savepagessort",i.projectid=t.getAttribute("data-projectid"),l="save pages sort",s=!0;break;case"folder":_=t.querySelectorAll(".tc-treelist__pagelist__folder"),r="data-folderid";i.comm="savefolderssort",i.projectid=t.getAttribute("data-projectid"),l="save folders sort",s=!0;break;case"project":_=t.querySelectorAll(".tc-sidebar__project__wrapper"),r="data-projectid";i.comm="saveprojectssort",l="saving projects order"}e=Array.prototype.map.call(_,function(e){return e.getAttribute(r)});i.sorts=e,i.csrt=getCSRF(),tc__treelist__ajax({url:"/projects/submit/",dataToSend:i,ui:{ctext:l},onSuccess:function(e){""!=e&&"OK"!=e||(check_logout(e),s&&(window.tc__treelist__needToRender=!0))},onError:function(){alert("Request timeout ("+l+")"),window.location.reload()}})}function tc__treelist__search__init(t){var i,l,e=t.querySelector(".js-treelist-search-button"),s=t.querySelector(".js-treelist-search-wrapper");s&&(i=s.querySelector(".js-treelist-search-input"),l={value:"",timer:"",projectWrapper:t,searchInput:i,inputCloseBtn:t.querySelector(".js-treelist-search-close")},e&&e.addEventListener("click",function(){window.tc__treelist__multiple&&window.tc__treelist__multiple.init&&window.tc__treelist__multiple.projectid===t.getAttribute("data-projectid")&&tc__treelist__multiple__clearSelection(t);var e=s.classList;e.toggle("tc-treelist__search__wrapper_opened"),t.classList.toggle("js-treelist-search-opened"),e.contains("tc-treelist__search__wrapper_opened")?i.focus():(tc__treelist__search__clear(l),setTimeout(function(){l.searchInput.value=""},300))}),l.searchInput.addEventListener("keyup",function(e){""===l.searchInput.value?(tc__treelist__search__clear(l),clearTimeout(l.timer),l.inputCloseBtn.style.display="none"):(l.inputCloseBtn.style.display="block",clearTimeout(l.timer),"Enter"===e.key?(l.value=l.searchInput.value,tc__treelist__search__do(l),clearTimeout(l.timer)):l.timer=setTimeout(function(){var e=l.searchInput.value;e!==l.value&&(3<=e.length?(l.value=e,tc__treelist__search__do):tc__treelist__search__clear)(l)},500))}),l.inputCloseBtn.addEventListener("click",function(){tc__treelist__search__clear(l),clearTimeout(l.timer),l.inputCloseBtn.style.display="none",l.searchInput.value="",i.focus()}))}function tc__treelist__search__do(e){var t=e.projectWrapper.querySelector(".js-treelist-container"),i=t.querySelectorAll(".tc-treelist__pagelist__folder"),l=t.querySelectorAll(".tc-treelist__page"),s=(s=e.value.toLowerCase()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=(tc__treelist__search__clear(e),Array.prototype.forEach.call(l,function(e){var t=e.querySelector(".tc-treelist__page__name"),i=e.querySelector(".tc-treelist__page__url"),l=t.innerHTML.toLowerCase(),t=(t=t.getAttribute("data-title")||"").toLowerCase(),i=(i=i?i.innerHTML:e.getAttribute("data-url"))?i.toLowerCase():"";-1===l.indexOf(s)&&-1===t.indexOf(s)&&-1===i.indexOf(s)?e.classList.add("tc-treelist__page_hidden"):e.classList.remove("tc-treelist__page_hidden")}),e.projectWrapper.querySelectorAll(".tc-treelist__page_hidden"));l.length===e.length?(Array.prototype.forEach.call(i,function(e){e.classList.add("tc-treelist__pagelist__folder_hidden")}),t.querySelector(".tc-treelist__pagelist__no-pages").classList.remove("tc-treelist__pagelist__no-pages_hidden")):Array.prototype.forEach.call(i,function(e){var t=e.querySelectorAll(".tc-treelist__page"),i=e.querySelectorAll(".tc-treelist__page_hidden");t.length===i.length?e.classList.add("tc-treelist__pagelist__folder_hidden"):(t=e.querySelector(".tc-treelist__arrow:not(.tc-treelist__arrow_opened)"))&&t.click()})}function tc__treelist__search__clear(e){e.value&&(e.value="");var t=e.projectWrapper.querySelectorAll(".tc-treelist__page"),i=e.projectWrapper.querySelectorAll(".tc-treelist__pagelist__folder");Array.prototype.forEach.call(t,function(e){e.classList.remove("tc-treelist__page_hidden")}),Array.prototype.forEach.call(i,function(e){var t=e.classList.contains("tc-treelist__pagelist__folder_current"),i=e.classList.contains("js-treelist-opened-folder");e.classList.remove("tc-treelist__pagelist__folder_hidden"),(t&&!i||!t&&i)&&e.querySelector(".tc-treelist__arrow").click()}),e.projectWrapper.querySelector(".tc-treelist__pagelist__no-pages").classList.add("tc-treelist__pagelist__no-pages_hidden")}function tc__treelist__search__closeAll(e){e=e.querySelectorAll(".tc-treelist__search__wrapper_opened");Array.prototype.forEach.call(e,function(e){var t,i=e.closest(".tc-sidebar__project__wrapper")||e.closest(".tp-menu__dropdown__menu");i&&(t={projectWrapper:i,searchInput:e.querySelector(".js-treelist-search-input")},setTimeout(function(){tc__treelist__search__clear(t),e.classList.toggle("tc-treelist__search__wrapper_opened"),t.searchInput.value=""},300))})}function tc__treelist__showPageSettings(i){tc__treelist__showLoader(),"object"!=typeof TUWidget&&(tc__loadCSSFile("/front/css/t-upload.min.css"),tc__loadJSFile("/front/js/t-upload.min.js")),tc__loadJSFile("/front/js/td-pagesettings-all.min.js?v="+window.ver,function(){tc__loadJSFile("/front/js/td-folders.min.js?v="+window.ver,function(){tc__loadJSFile("/front/js/td-other.min.js?v="+window.ver,function(){tc__loadJSFile("/front/js/punicode.min.js?v="+window.ver,function(){var e={comm:"getpagesettings",pageid:i,js:"js3page",csrf:getCSRF()},t=(document.getElementById("popup_pagesettings")||document.body.insertAdjacentHTML("beforeend",'<div class="td-popup" id="popup_pagesettings"><div class="td-popup__wrap"><div class="td-popup-window"></div></div></div>'),showpopup("#popup_pagesettings",""),td__pagesettings__drawBody(i),document.querySelector("#popup_pagesettings .td-popup-window__middle"));t&&t.insertAdjacentHTML("beforeend",'<div style="text-align:center; padding:100px;" id="pagesettingsloader"><img src="/tpl/img/ajax-loader.gif"></div>'),init_popup(),td__load("/projects/get/getpagesettings/",e,{ctext:"opening page settings dialog"},function(e){var t=document.getElementById("pagesettingsloader");t&&t.remove(),td__pagesettings__init(e)}),tc__treelist__hideLoader()})})})})}function tc__treelist__showLoader(){document.querySelector(".tc-sidebar_opened")&&"function"==typeof tc__sidebar__showLoader?tc__sidebar__showLoader():"function"==typeof showLoadIcon&&showLoadIcon()}function tc__treelist__hideLoader(){document.querySelector(".tc-sidebar_opened")&&"function"==typeof tc__sidebar__hideLoader?tc__sidebar__hideLoader():"function"==typeof hideLoadIcon&&hideLoadIcon()}function tc__treelist__multiple__init(e){var e=e.querySelectorAll(".tc-treelist__page a"),t=tc__treelist__multiple__defineHotkey();window.tc__treelist__multiple={},window.tc__treelist__multiple.pages=[],window.tc__treelist__multiple.isMultiple=!1,window.tc__treelist__multiple.isShiftMultiple=!1,document.body.addEventListener("keydown",function(e){e=e.key;e&&e==t&&(window.tc__treelist__multiple.isMultiple=!0,window.tc__treelist__multiple.isShiftMultiple=!1),"Shift"==e&&(window.tc__treelist__multiple.isMultiple=!1,window.tc__treelist__multiple.isShiftMultiple=!0)}),document.body.addEventListener("keyup",function(){window.tc__treelist__multiple.isMultiple=!1,window.tc__treelist__multiple.isShiftMultiple=!1}),e.forEach(function(e){e.addEventListener("click",tc__treelist__multiple__addEventToPage)})}function tc__treelist__multiple__addEventToPage(e){if(window.tc__treelist__multiple.isMultiple||window.tc__treelist__multiple.isShiftMultiple){var t=e.target.closest(".tc-sidebar__project__wrapper")||e.target.closest(".tp-menu__dropdown__menu");if(!t||!t.classList.contains("js-treelist-search-opened")){e.preventDefault();var t=document.querySelector(".tc-sidebar_opened")||document.querySelector(".tp-menu__dropdown__menu_opened"),i=(window.tc__treelist__multiple.init=!0,e.target.closest(".tc-treelist__page")),l=i.classList.contains("tc__treelist__multiple_selected"),e=i.closest(".tc-treelist__page__sortable-container")||i.closest(".js-treelist-container"),s=t.querySelector(".js-treelist-multiple-wrapper");if(s&&e===s||(s&&e!==s&&tc__treelist__multiple__clearSelection(s),e.classList.add("js-treelist-multiple-wrapper"),window.tc__treelist__multiple.projectid=i.getAttribute("data-projectid"),window.tc__treelist__multiple.folderid=i.getAttribute("data-folderid")),window.tc__treelist__multiple.isShiftMultiple&&!window.tc__treelist__multiple.isMultiple)if(e.querySelector(".js-treelist-multiple-lastSelected")){function _(e){var t=a[n],e=1===e?t.previousSibling:t.nextSibling;t.classList.contains("js-treelist-multiple-lastSelected")&&(o=!0),e===i&&(c=!0),o&&!c&&tc__treelist__selectUnselectOne(l,t)}for(var r,a=e.querySelectorAll(".tc-treelist__page"),o=!1,c=!1,n=0;n<a.length;n++){var p=a[n];if(p===i){r=-1;break}if(p.classList.contains("js-treelist-multiple-lastSelected")){r=1;break}}if(1===r)for(n=0;n<a.length;n++)_(r);else if(-1===r)for(n=a.length-1;0<=n;n--)_(r)}else tc__treelist__multiple__selectPage(i,e);else window.tc__treelist__multiple.isMultiple&&!window.tc__treelist__multiple.isShiftMultiple&&tc__treelist__selectUnselectOne(l,i);0===t.querySelectorAll(".tc__treelist__multiple_selected").length&&tc__treelist__multiple__clearSelection(t)}}}function tc__treelist__selectUnselectOne(e,t){(e?tc__treelist__multiple__unselectPage:tc__treelist__multiple__selectPage)(t)}function tc__treelist__multiple__selectPage(e){var t;e.classList.contains("tc__treelist__multiple_selected")||((t=(e.closest(".tc-treelist__page__sortable-container")||e.closest(".js-treelist-container")).querySelector(".js-treelist-multiple-lastSelected"))&&t.classList.remove("js-treelist-multiple-lastSelected"),e.classList.add("js-treelist-multiple-lastSelected"),e.classList.add("tc__treelist__multiple_selected"),window.tc__treelist__multiple.pages.push(e))}function tc__treelist__multiple__unselectPage(e){var t;e.classList.contains("tc__treelist__multiple_selected")&&(t=e.getAttribute("data-pageid"),e.classList.remove("tc__treelist__multiple_selected"),window.tc__treelist__multiple.pages=window.tc__treelist__multiple.pages.filter(function(e){return e.getAttribute("data-pageid")!==t}),e.classList.contains("js-treelist-multiple-lastSelected"))&&(e.classList.remove("js-treelist-multiple-lastSelected"),window.tc__treelist__multiple.pages.length)&&window.tc__treelist__multiple.pages[window.tc__treelist__multiple.pages.length-1].classList.add("js-treelist-multiple-lastSelected")}function tc__treelist__multiple__clearSelection(e){var t=e.querySelectorAll(".tc__treelist__multiple_selected"),t=(Array.prototype.forEach.call(t,function(e){e.classList.remove("tc__treelist__multiple_selected")}),e.querySelector(".js-treelist-multiple-wrapper"));(t=!t&&e.classList.contains("js-treelist-multiple-wrapper")?e:t)&&(t.classList.remove("js-treelist-multiple-wrapper"),e=t.querySelector(".js-treelist-multiple-lastSelected"))&&e.classList.remove("js-treelist-multiple-lastSelected"),window.tc__treelist__multiple.init=!1,window.tc__treelist__multiple.pages=[],window.tc__treelist__multiple.projectid="",window.tc__treelist__multiple.folderid=""}function tc__treelist__multiple__defineHotkey(){var e=-1<navigator.userAgent.indexOf("Macintosh")?"Meta":"Control";return e}function tc__treelist__ajax__encodeData(e,l){var t,s="";if(Array.isArray(e))Array.prototype.forEach.call(e,function(e,t){var i;"object"==typeof e&&"name"in e?(s+=s?"&":"",i="",i=l?encodeURIComponent(l+"["+e.name+"]"):encodeURIComponent(e.name),s+=i+"="+encodeURIComponent(e.value)):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?(s+=s?"&":"",i="",i=l?encodeURIComponent(l+"["+t+"]"):encodeURIComponent(t),s+=i+"="+encodeURIComponent(e)):"object"==typeof e&&(s=(s+=s?"&":"")+tc__treelist__ajax__encodeData(e,l?l+"["+t+"]":t))});else if("object"==typeof e&&null!==e)for(var i in e)s+=s?"&":"","object"==typeof e[i]&&null!==e?s+=tc__treelist__ajax__encodeData(e[i],l?l+"["+i+"]":i):"string"!=typeof e[i]&&"number"!=typeof e[i]&&"boolean"!=typeof e[i]&&null!==e[i]||(t="",t=l?encodeURIComponent(l+"["+i+"]"):encodeURIComponent(i),s+=t+"="+encodeURIComponent(e[i]));return s}function tc__treelist__ajax(e){var t,i,l,s=e.url,_=e.dataToSend||"",r=e.ui||{isQuiet:!1,ctext:""},a=(r.ctext||(r.ctext=""),e.onSuccess),o=e.onError,c=e.onComplete,n=e.responseType||"text",p=e.method||"POST",e=e.timeout||25e3;if(s)return t=!1,"/page/publish/"===s||r.isQuiet||(tc__treelist__showLoader(),t=!0),i=Date.now(),(l=new XMLHttpRequest).open(p,s,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),l.timeout=e,l.responseType=n,e=tc__treelist__ajax__encodeData(_),l.addEventListener("loadend",function(){200<=this.status&&this.status<400&&(t&&tc__treelist__hideLoader(),"function"==typeof a&&a.call(this,"json"===n?this.response:this.responseText),"function"==typeof c)&&c.call(this)}),l.addEventListener("timeout",function(){t&&tc__treelist__hideLoader();var e=Date.now()-i;logNetworkError("ajax",s,_,e/1e3,{}),r.isQuiet||alert("Request timeout ("+r.ctext+"). Please reload the page and try again."),"function"==typeof o&&o.call(this),"function"==typeof c&&c.call(this)}),l.addEventListener("abort",function(){t&&tc__treelist__hideLoader(),"function"==typeof o&&o.call(this),"function"==typeof c&&c.call(this)}),l.addEventListener("error",function(){t&&tc__treelist__hideLoader();var e=Date.now()-i;console.log(this.status),400<=l.status?(r.isQuiet||td__showBubbleNotice("Error status: "+this.status+". (action: "+r.ctext+")",6e3,"error"),logAjaxError(s,_,"comm: "+_.comm+", (td__ajax)",l.status,{ts_delta:parseInt(e/1e3),exception:"error",ui:r})):0===l.status&&e<100&&!r.isQuiet&&alert("Request error ("+r.ctext+"). Please check your Internet connection and try again."),"function"==typeof o&&o.call(this),"function"==typeof c&&c.call(this)}),e&&"POST"===p?l.send(e):l.send(),l}function tc__treelist__scrollTo(i,l,s){var _,r;i&&("string"==typeof scrollTop&&(l=l.replace("px","")),l=parseInt(l,10),isNaN(l)||(s=s||600,_=i.scrollTop,requestAnimationFrame(function e(t){t=(t=(t-(r=r||t))/s)<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2;i.scrollTop=(l-_)*Math.min(t,1)+_,t<1?requestAnimationFrame(e):i.scrollTop=l})))}function tc__treelist__initTooltipster(t){"function"!=typeof tooltipster&&(tc__loadCSSFile("https://static.tildacdn.com/css/tooltipster.min.css"),tc__loadJSFile("https://static.tildacdn.com/js/tilda-tooltip-1.0.min.js")),tc__onFuncLoad("tooltipster",function(){var e=t.querySelectorAll(".tc-treelist__tooltip");window.tooltipster(e,{theme:"tc-treelist__tooltip_noir",contentAsHTML:!0,position:"top",delay:400,minWidth:50,maxWidth:300})})}
